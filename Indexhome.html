<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    .table-container {
      overflow-x: auto;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    
    th {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 8px;
      text-align: center;
      font-weight: 600;
      font-size: 14px;
      border: 1px solid #5a67d8;
    }
    
    td {
      padding: 10px 8px;
      text-align: center;
      border: 1px solid #e2e8f0;
      font-size: 13px;
    }
    
    tr:nth-child(even) {
      background-color: #f7fafc;
    }
    
    tr:hover {
      background-color: #edf2f7;
    }
    
    .owner-badge {
      background-color: #48bb78;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .tenant-badge {
      background-color: #4299e1;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .paid-badge {
      background-color: #48bb78;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .unpaid-badge {
      background-color: #f56565;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .partial-badge {
      background-color: #ed8936;
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: white;
      padding: 24px;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      max-height: 90%;
      overflow-y: auto;
    }
    
    .form-group {
      margin-bottom: 16px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: #2d3748;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #cbd5e0;
      border-radius: 6px;
      font-size: 14px;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .loading {
      opacity: 0.6;
      pointer-events: none;
    }

    .backup-section {
      background: #f8f9fa;
      border: 2px dashed #dee2e6;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      margin: 20px 0;
    }

    .backup-section input[type="file"] {
      display: none;
    }

    .backup-section label {
      background: #007bff;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      display: inline-block;
      margin: 5px;
    }

    .backup-section label:hover {
      background: #0056b3;
    }

    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .action-buttons button {
      width: 100%;
      font-size: 11px;
      padding: 4px 6px;
    }

    optgroup {
      font-weight: bold;
      color: #4a5568;
      background-color: #f7fafc;
    }

    optgroup option {
      font-weight: normal;
      color: #2d3748;
      background-color: white;
      padding-left: 20px;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-50">
  <div class="min-h-full p-6">
   <div class="max-w-7xl mx-auto"><!-- Header -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
     <h1 class="text-3xl font-bold text-gray-800 mb-2">ğŸ¢ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±</h1>
     <div class="flex items-center justify-between flex-wrap gap-4">
      <div>
       <h2 class="text-xl text-gray-600">ØªØ¬Ù…ÙŠØ¹ Ø§ÙŠØµØ§Ù„ Ø´Ù‡Ø±</h2>
       <p class="text-gray-500 mt-1">Ø¹Ø§Ù… 2025 Ù…</p>
      </div>
      <div class="flex gap-3 flex-wrap"><button id="backup-btn" class="bg-gradient-to-r from-yellow-600 to-orange-600 text-white px-4 py-2 rounded-lg font-semibold hover:from-yellow-700 hover:to-orange-700 transition-all shadow-md text-sm"> ğŸ’¾ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ </button> <button id="export-btn" class="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-4 py-2 rounded-lg font-semibold hover:from-green-700 hover:to-emerald-700 transition-all shadow-md text-sm"> ğŸ“Š ØªØµØ¯ÙŠØ± Excel </button> <button id="print-btn" class="bg-gradient-to-r from-blue-600 to-cyan-600 text-white px-4 py-2 rounded-lg font-semibold hover:from-blue-700 hover:to-cyan-700 transition-all shadow-md text-sm"> ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© </button> <button id="add-debt-btn" class="bg-gradient-to-r from-red-600 to-pink-600 text-white px-4 py-2 rounded-lg font-semibold hover:from-red-700 hover:to-pink-700 transition-all shadow-md text-sm"> ğŸ“‹ ØªØ³Ø¬ÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© </button> <button id="add-payment-btn" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition-all shadow-md"> Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø© </button>
      </div>
     </div>
    </div><!-- Statistics -->
    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
     <div class="bg-white rounded-lg shadow-md p-4">
      <div class="text-gray-500 text-sm mb-1">
       Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ù‚Ù‚
      </div>
      <div id="total-apartments" class="text-2xl font-bold text-gray-800">
       21
      </div>
     </div>
     <div class="bg-white rounded-lg shadow-md p-4">
      <div class="text-gray-500 text-sm mb-1">
       Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ØµÙ„
      </div>
      <div id="total-paid" class="text-2xl font-bold text-green-600">
       0 Ø¬Ù†ÙŠÙ‡
      </div>
     </div>
     <div class="bg-white rounded-lg shadow-md p-4">
      <div class="text-gray-500 text-sm mb-1">
       Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†
      </div>
      <div id="total-debt" class="text-2xl font-bold text-red-600">
       0 Ø¬Ù†ÙŠÙ‡
      </div>
     </div>
     <div class="bg-white rounded-lg shadow-md p-4">
      <div class="text-gray-500 text-sm mb-1">
       Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ†
      </div>
      <div id="total-tenants" class="text-2xl font-bold text-blue-600">
       10
      </div>
     </div>
     <div class="bg-white rounded-lg shadow-md p-4">
      <div class="text-gray-500 text-sm mb-1">
       Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ­ØµÙŠÙ„
      </div>
      <div id="collection-rate" class="text-2xl font-bold text-purple-600">
       0%
      </div>
     </div>
    </div><!-- Filters -->
    <div class="bg-white rounded-lg shadow-md p-4 mb-6">
     <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ” Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©</h3>
     <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…</label> <input type="text" id="search-name" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§ÙƒÙ†..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø³Ø§ÙƒÙ†</label> <select id="filter-type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"> <option value="">Ø§Ù„ÙƒÙ„</option> <option value="Ù…Ø§Ù„Ùƒ">Ù…Ø§Ù„Ùƒ</option> <option value="Ù…Ø³ØªØ£Ø¬Ø±">Ù…Ø³ØªØ£Ø¬Ø±</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯</label> <select id="filter-payment" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"> <option value="">Ø§Ù„ÙƒÙ„</option> <option value="Ù…Ø¯ÙÙˆØ¹">Ù…Ø¯ÙÙˆØ¹</option> <option value="ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</option> <option value="Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ">Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¯ÙˆØ±</label> <select id="filter-floor" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"> <option value="">Ø§Ù„ÙƒÙ„</option> </select>
      </div>
     </div>
     <div class="mt-4 flex gap-2"><button id="clear-filters" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-all"> Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ± </button>
     </div>
    </div><!-- Table -->
    <div class="bg-white rounded-lg shadow-md p-4">
     <div class="table-container">
      <table id="apartments-table">
       <thead>
        <tr>
         <th>Ù…</th>
         <th>Ø§Ù„Ø¯ÙˆØ±</th>
         <th>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©</th>
         <th>Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ù‚Ø©</th>
         <th>Ø§Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ†</th>
         <th>Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ù‚Ø©</th>
         <th>Ù†ÙˆØ¹ Ø§Ù„Ø³Ø§ÙƒÙ†</th>
         <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
         <th>Ø¯ÙØ¹</th>
         <th>Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯</th>
         <th>Ø¯ÙŠÙˆÙ†</th>
         <th>Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø©</th>
         <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
         <th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</th>
         <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
       </thead>
       <tbody id="table-body">
       </tbody>
      </table>
     </div>
    </div>
   </div>
  </div><!-- Add/Edit Payment Modal -->
  <div id="payment-modal" class="modal">
   <div class="modal-content">
    <h3 id="modal-title" class="text-2xl font-bold text-gray-800 mb-4">Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
    <form id="payment-form">
     <div class="form-group"><label>Ø§Ù„Ø´Ù‚Ø©</label> <select id="apartment-select" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‚Ø©</option> </select>
     </div>
     <div class="form-group"><label>Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø©</label> <select id="payment-type-input"> <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø©</option> <optgroup label="ğŸ’° Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±Ø§Øª"> <option value="Ø¥ÙŠØ¬Ø§Ø± Ø´Ù‡Ø±ÙŠ">ğŸ’° Ø¥ÙŠØ¬Ø§Ø± Ø´Ù‡Ø±ÙŠ</option> <option value="Ø¥ÙŠØ¬Ø§Ø± Ù…Ù‚Ø¯Ù…">ğŸ’µ Ø¥ÙŠØ¬Ø§Ø± Ù…Ù‚Ø¯Ù…</option> <option value="ØªØ£Ù…ÙŠÙ† Ø¥ÙŠØ¬Ø§Ø±">ğŸ›¡ï¸ ØªØ£Ù…ÙŠÙ† Ø¥ÙŠØ¬Ø§Ø±</option> <option value="Ø²ÙŠØ§Ø¯Ø© Ø¥ÙŠØ¬Ø§Ø±">ğŸ“ˆ Ø²ÙŠØ§Ø¯Ø© Ø¥ÙŠØ¬Ø§Ø±</option> <option value="Ø¹Ù…ÙˆÙ„Ø© ØªØ³ÙˆÙŠÙ‚">ğŸ¤ Ø¹Ù…ÙˆÙ„Ø© ØªØ³ÙˆÙŠÙ‚</option> </optgroup> <optgroup label="ğŸ”§ Ø§Ù„ØµÙŠØ§Ù†Ø©"> <option value="ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ©">ğŸ”§ ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ©</option> <option value="Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø·Ø§Ø±Ø¦Ø©">âš¡ Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø·Ø§Ø±Ø¦Ø©</option> <option value="ØªØ¬Ø¯ÙŠØ¯Ø§Øª">ğŸ—ï¸ ØªØ¬Ø¯ÙŠØ¯Ø§Øª</option> <option value="ØµÙŠØ§Ù†Ø© Ù…ØµØ¹Ø¯">ğŸ›— ØµÙŠØ§Ù†Ø© Ù…ØµØ¹Ø¯</option> <option value="Ø·Ù„Ø§Ø¡ ÙˆØªØ±Ù…ÙŠÙ…">ğŸ¨ Ø·Ù„Ø§Ø¡ ÙˆØªØ±Ù…ÙŠÙ…</option> </optgroup> <optgroup label="âš¡ Ø§Ù„Ø®Ø¯Ù…Ø§Øª"> <option value="ÙÙˆØ§ØªÙŠØ± ÙƒÙ‡Ø±Ø¨Ø§Ø¡">âš¡ ÙÙˆØ§ØªÙŠØ± ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option> <option value="ÙÙˆØ§ØªÙŠØ± Ù…ÙŠØ§Ù‡">ğŸ’§ ÙÙˆØ§ØªÙŠØ± Ù…ÙŠØ§Ù‡</option> <option value="ÙÙˆØ§ØªÙŠØ± ØºØ§Ø²">ğŸ”¥ ÙÙˆØ§ØªÙŠØ± ØºØ§Ø²</option> <option value="Ø¥Ù†ØªØ±Ù†Øª ÙˆØªÙ„ÙŠÙÙˆÙ†">ğŸ“ Ø¥Ù†ØªØ±Ù†Øª ÙˆØªÙ„ÙŠÙÙˆÙ†</option> <option value="Ø®Ø¯Ù…Ø© Ø£Ù…Ù† ÙˆØ­Ø±Ø§Ø³Ø©">ğŸ›¡ï¸ Ø®Ø¯Ù…Ø© Ø£Ù…Ù† ÙˆØ­Ø±Ø§Ø³Ø©</option> <option value="Ø®Ø¯Ù…Ø© Ù†Ø¸Ø§ÙØ©">ğŸ§¹ Ø®Ø¯Ù…Ø© Ù†Ø¸Ø§ÙØ©</option> </optgroup> <optgroup label="ğŸ“‹ Ø±Ø³ÙˆÙ… Ø¥Ø¯Ø§Ø±ÙŠØ©"> <option value="Ø±Ø³ÙˆÙ… Ø¥Ø¯Ø§Ø±ÙŠØ©">ğŸ“‹ Ø±Ø³ÙˆÙ… Ø¥Ø¯Ø§Ø±ÙŠØ©</option> <option value="ØºØ±Ø§Ù…Ø§Øª">âš ï¸ ØºØ±Ø§Ù…Ø§Øª</option> <option value="Ø±Ø³ÙˆÙ… ØªØ­ØµÙŠÙ„">ğŸ’¼ Ø±Ø³ÙˆÙ… ØªØ­ØµÙŠÙ„</option> <option value="Ø±Ø³ÙˆÙ… Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©">âš–ï¸ Ø±Ø³ÙˆÙ… Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</option> </optgroup> <optgroup label="ğŸ”„ Ø£Ø®Ø±Ù‰"> <option value="Ù…ØµØ§Ø±ÙŠÙ Ù…ØªÙ†ÙˆØ¹Ø©">ğŸ“Š Ù…ØµØ§Ø±ÙŠÙ Ù…ØªÙ†ÙˆØ¹Ø©</option> <option value="ØªØ¹ÙˆÙŠØ¶Ø§Øª">ğŸ’° ØªØ¹ÙˆÙŠØ¶Ø§Øª</option> <option value="Ø£Ø®Ø±Ù‰">â“ Ø£Ø®Ø±Ù‰</option> </optgroup> </select>
     </div>
     <div class="form-group"><label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</label> <input type="number" id="amount-input" min="0" step="0.01" required>
     </div>
     <div class="form-group"><label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹</label> <input type="number" id="paid-input" min="0" step="0.01" required>
     </div>
     <div class="form-group"><label>Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯</label> <select id="payment-status-input" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø­Ø§Ù„Ø©</option> <option value="Ù…Ø¯ÙÙˆØ¹">âœ… Ù…Ø¯ÙÙˆØ¹</option> <option value="ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹">âŒ ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</option> <option value="Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ">âš ï¸ Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ</option> </select>
     </div>
     <div class="form-group"><label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label> <select id="payment-method-input"> <option value="">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</option> <optgroup label="ğŸ’µ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª"> <option value="Ù†Ù‚Ø¯ÙŠ">ğŸ’µ Ù†Ù‚Ø¯ÙŠ</option> <option value="ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ">ğŸ¦ ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ</option> <option value="Ø¥ÙŠØ¯Ø§Ø¹ Ø¨Ù†ÙƒÙŠ">ğŸ§ Ø¥ÙŠØ¯Ø§Ø¹ Ø¨Ù†ÙƒÙŠ</option> <option value="Ø´ÙŠÙƒ">ğŸ“ Ø´ÙŠÙƒ</option> </optgroup> <optgroup label="ğŸ“± Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©"> <option value="ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´">ğŸ“± ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</option> <option value="Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ">ğŸ’³ Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ</option> <option value="Ø£ÙˆØ±Ø§Ù†Ø¬ Ù…ÙˆÙ†ÙŠ">ğŸŸ  Ø£ÙˆØ±Ø§Ù†Ø¬ Ù…ÙˆÙ†ÙŠ</option> <option value="Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´">ğŸ”µ Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´</option> <option value="ÙˆÙŠ Ø¨Ø§ÙŠ">ğŸ’° ÙˆÙŠ Ø¨Ø§ÙŠ</option> </optgroup> <optgroup label="ğŸ’³ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©"> <option value="ÙÙŠØ²Ø§">ğŸ’³ ÙÙŠØ²Ø§</option> <option value="Ù…Ø§Ø³ØªØ±ÙƒØ§Ø±Ø¯">ğŸ’³ Ù…Ø§Ø³ØªØ±ÙƒØ§Ø±Ø¯</option> <option value="Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù† Ø£Ø®Ø±Ù‰">ğŸ’³ Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù† Ø£Ø®Ø±Ù‰</option> </optgroup> <optgroup label="ğŸ”„ Ø·Ø±Ù‚ Ø£Ø®Ø±Ù‰"> <option value="ØªÙ‚Ø³ÙŠØ·">ğŸ“Š ØªÙ‚Ø³ÙŠØ·</option> <option value="Ø®ØµÙ… Ù…Ù† Ø§Ù„ØªØ£Ù…ÙŠÙ†">ğŸ”„ Ø®ØµÙ… Ù…Ù† Ø§Ù„ØªØ£Ù…ÙŠÙ†</option> <option value="Ù…Ù‚Ø§ÙŠØ¶Ø© Ø®Ø¯Ù…Ø§Øª">ğŸ¤ Ù…Ù‚Ø§ÙŠØ¶Ø© Ø®Ø¯Ù…Ø§Øª</option> <option value="Ø£Ø®Ø±Ù‰">â“ Ø£Ø®Ø±Ù‰</option> </optgroup> </select>
     </div>
     <div class="form-group"><label>Ø§Ù„Ø´Ù‡Ø±</label> <select id="month-input" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</option> <option value="ÙŠÙ†Ø§ÙŠØ±">ÙŠÙ†Ø§ÙŠØ±</option> <option value="ÙØ¨Ø±Ø§ÙŠØ±">ÙØ¨Ø±Ø§ÙŠØ±</option> <option value="Ù…Ø§Ø±Ø³">Ù…Ø§Ø±Ø³</option> <option value="Ø£Ø¨Ø±ÙŠÙ„">Ø£Ø¨Ø±ÙŠÙ„</option> <option value="Ù…Ø§ÙŠÙˆ">Ù…Ø§ÙŠÙˆ</option> <option value="ÙŠÙˆÙ†ÙŠÙˆ">ÙŠÙˆÙ†ÙŠÙˆ</option> <option value="ÙŠÙˆÙ„ÙŠÙˆ">ÙŠÙˆÙ„ÙŠÙˆ</option> <option value="Ø£ØºØ³Ø·Ø³">Ø£ØºØ³Ø·Ø³</option> <option value="Ø³Ø¨ØªÙ…Ø¨Ø±">Ø³Ø¨ØªÙ…Ø¨Ø±</option> <option value="Ø£ÙƒØªÙˆØ¨Ø±">Ø£ÙƒØªÙˆØ¨Ø±</option> <option value="Ù†ÙˆÙÙ…Ø¨Ø±">Ù†ÙˆÙÙ…Ø¨Ø±</option> <option value="Ø¯ÙŠØ³Ù…Ø¨Ø±">Ø¯ÙŠØ³Ù…Ø¨Ø±</option> </select>
     </div>
     <div class="form-group"><label>Ø§Ù„Ø³Ù†Ø©</label> <input type="number" id="year-input" value="2025" required>
     </div>
     <div class="form-group"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label> <textarea id="notes-input" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
     </div>
     <div class="flex gap-3 mt-6"><button type="submit" id="submit-btn" class="flex-1 bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-indigo-700 transition-all"> Ø­ÙØ¸ </button> <button type="button" id="cancel-btn" class="flex-1 bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition-all"> Ø¥Ù„ØºØ§Ø¡ </button>
     </div>
    </form>
   </div>
  </div><!-- Edit Apartment Modal -->
  <div id="apartment-modal" class="modal">
   <div class="modal-content">
    <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ  ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‚Ø©</h3>
    <form id="apartment-form">
     <div class="form-group"><label>Ø§Ù„Ø¯ÙˆØ±</label> <input type="text" id="apt-floor-input" required placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø£ÙˆÙ„">
     </div>
     <div class="form-group"><label>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©</label> <input type="text" id="apt-number-input" required placeholder="Ù…Ø«Ø§Ù„: 101">
     </div>
     <div class="form-group"><label>Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ù‚Ø©</label> <select id="apt-location-input" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙƒØ§Ù†</option> <option value="ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…">ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…</option> <option value="ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…">ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…</option> <option value="ÙˆØ³Ø·">ÙˆØ³Ø·</option> </select>
     </div>
     <div class="form-group"><label>Ø§Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ†</label> <input type="text" id="apt-resident-input" required placeholder="Ù…Ø«Ø§Ù„: Ø£ - Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯">
     </div>
     <div class="form-group"><label>Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ù‚Ø©</label> <select id="apt-status-input" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø­Ø§Ù„Ø©</option> <option value="Ø³Ø§ÙƒÙ†Ø©">Ø³Ø§ÙƒÙ†Ø©</option> <option value="ÙØ§Ø±ØºØ©">ÙØ§Ø±ØºØ©</option> <option value="ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©">ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©</option> </select>
     </div>
     <div class="form-group"><label>Ù†ÙˆØ¹ Ø§Ù„Ø³Ø§ÙƒÙ†</label> <select id="apt-type-input" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option> <option value="Ù…Ø§Ù„Ùƒ">Ù…Ø§Ù„Ùƒ</option> <option value="Ù…Ø³ØªØ£Ø¬Ø±">Ù…Ø³ØªØ£Ø¬Ø±</option> </select>
     </div>
     <div class="flex gap-3 mt-6"><button type="submit" id="apt-submit-btn" class="flex-1 bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-green-700 hover:to-emerald-700 transition-all"> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª </button> <button type="button" id="apt-cancel-btn" class="flex-1 bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition-all"> Ø¥Ù„ØºØ§Ø¡ </button>
     </div>
    </form>
   </div>
  </div><!-- Debt Registration Modal -->
  <div id="debt-modal" class="modal">
   <div class="modal-content">
    <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“‹ ØªØ³Ø¬ÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
    <form id="debt-form">
     <div class="form-group"><label>Ø§Ù„Ø´Ù‚Ø©</label> <select id="debt-apartment-select" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‚Ø©</option> </select>
     </div>
     <div class="form-group"><label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</label> <select id="debt-type-input" required> <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</option> <optgroup label="ğŸ’° Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©"> <option value="Ø¥ÙŠØ¬Ø§Ø± Ø´Ù‡Ø±ÙŠ">ğŸ’° Ø¥ÙŠØ¬Ø§Ø± Ø´Ù‡Ø±ÙŠ</option> <option value="Ø¥ÙŠØ¬Ø§Ø± Ù…ØªØ£Ø®Ø±">â° Ø¥ÙŠØ¬Ø§Ø± Ù…ØªØ£Ø®Ø±</option> <option value="Ø²ÙŠØ§Ø¯Ø© Ø¥ÙŠØ¬Ø§Ø±">ğŸ“ˆ Ø²ÙŠØ§Ø¯Ø© Ø¥ÙŠØ¬Ø§Ø±</option> <option value="ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø´Ù‚Ø©">ğŸ›¡ï¸ ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø´Ù‚Ø©</option> <option value="Ø¹Ù…ÙˆÙ„Ø© ØªØ³ÙˆÙŠÙ‚">ğŸ¤ Ø¹Ù…ÙˆÙ„Ø© ØªØ³ÙˆÙŠÙ‚</option> </optgroup> <optgroup label="ğŸ”§ Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª"> <option value="ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ©">ğŸ”§ ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ©</option> <option value="Ø¥ØµÙ„Ø§Ø­ Ø³Ø¨Ø§ÙƒØ©">ğŸš¿ Ø¥ØµÙ„Ø§Ø­ Ø³Ø¨Ø§ÙƒØ©</option> <option value="Ø¥ØµÙ„Ø§Ø­ ÙƒÙ‡Ø±Ø¨Ø§Ø¡">âš¡ Ø¥ØµÙ„Ø§Ø­ ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option> <option value="ØµÙŠØ§Ù†Ø© Ù…ØµØ¹Ø¯">ğŸ›— ØµÙŠØ§Ù†Ø© Ù…ØµØ¹Ø¯</option> <option value="Ø·Ù„Ø§Ø¡ ÙˆØªØ±Ù…ÙŠÙ…">ğŸ¨ Ø·Ù„Ø§Ø¡ ÙˆØªØ±Ù…ÙŠÙ…</option> <option value="ØªØºÙŠÙŠØ± Ø£Ù‚ÙØ§Ù„">ğŸ” ØªØºÙŠÙŠØ± Ø£Ù‚ÙØ§Ù„</option> <option value="Ø¥ØµÙ„Ø§Ø­ ØªÙƒÙŠÙŠÙ">â„ï¸ Ø¥ØµÙ„Ø§Ø­ ØªÙƒÙŠÙŠÙ</option> </optgroup> <optgroup label="âš¡ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ù…Ø±Ø§ÙÙ‚"> <option value="ÙØ§ØªÙˆØ±Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¡">âš¡ ÙØ§ØªÙˆØ±Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option> <option value="ÙØ§ØªÙˆØ±Ø© Ù…ÙŠØ§Ù‡">ğŸ’§ ÙØ§ØªÙˆØ±Ø© Ù…ÙŠØ§Ù‡</option> <option value="ÙØ§ØªÙˆØ±Ø© ØºØ§Ø²">ğŸ”¥ ÙØ§ØªÙˆØ±Ø© ØºØ§Ø²</option> <option value="Ø¥Ù†ØªØ±Ù†Øª ÙˆØªÙ„ÙŠÙÙˆÙ†">ğŸ“ Ø¥Ù†ØªØ±Ù†Øª ÙˆØªÙ„ÙŠÙÙˆÙ†</option> <option value="ØªÙ„ÙØ²ÙŠÙˆÙ† ÙƒØ§Ø¨Ù„">ğŸ“º ØªÙ„ÙØ²ÙŠÙˆÙ† ÙƒØ§Ø¨Ù„</option> <option value="Ø®Ø¯Ù…Ø© Ø£Ù…Ù† ÙˆØ­Ø±Ø§Ø³Ø©">ğŸ›¡ï¸ Ø®Ø¯Ù…Ø© Ø£Ù…Ù† ÙˆØ­Ø±Ø§Ø³Ø©</option> <option value="Ø®Ø¯Ù…Ø© Ù†Ø¸Ø§ÙØ©">ğŸ§¹ Ø®Ø¯Ù…Ø© Ù†Ø¸Ø§ÙØ©</option> </optgroup> <optgroup label="ğŸ“‹ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©"> <option value="Ø±Ø³ÙˆÙ… Ø¥Ø¯Ø§Ø±ÙŠØ©">ğŸ“‹ Ø±Ø³ÙˆÙ… Ø¥Ø¯Ø§Ø±ÙŠØ©</option> <option value="Ø±Ø³ÙˆÙ… ØªØ­ØµÙŠÙ„">ğŸ’¼ Ø±Ø³ÙˆÙ… ØªØ­ØµÙŠÙ„</option> <option value="ØºØ±Ø§Ù…Ø© ØªØ£Ø®ÙŠØ±">âš ï¸ ØºØ±Ø§Ù…Ø© ØªØ£Ø®ÙŠØ±</option> <option value="Ø±Ø³ÙˆÙ… Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©">âš–ï¸ Ø±Ø³ÙˆÙ… Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</option> <option value="Ø±Ø³ÙˆÙ… Ù…Ø­ÙƒÙ…Ø©">ğŸ›ï¸ Ø±Ø³ÙˆÙ… Ù…Ø­ÙƒÙ…Ø©</option> <option value="Ø£ØªØ¹Ø§Ø¨ Ù…Ø­Ø§Ù…Ø§Ø©">ğŸ‘¨â€ğŸ’¼ Ø£ØªØ¹Ø§Ø¨ Ù…Ø­Ø§Ù…Ø§Ø©</option> </optgroup> <optgroup label="ğŸ—ï¸ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª ÙˆØ§Ù„Ø¥Ø¶Ø§ÙØ§Øª"> <option value="ØªØ±ÙƒÙŠØ¨ Ø¬Ø¯ÙŠØ¯">ğŸ”§ ØªØ±ÙƒÙŠØ¨ Ø¬Ø¯ÙŠØ¯</option> <option value="ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø´Ù‚Ø©">ğŸ—ï¸ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø´Ù‚Ø©</option> <option value="Ø£Ø¬Ù‡Ø²Ø© ÙˆÙ…Ø¹Ø¯Ø§Øª">ğŸ“± Ø£Ø¬Ù‡Ø²Ø© ÙˆÙ…Ø¹Ø¯Ø§Øª</option> <option value="ØªØ¬Ø¯ÙŠØ¯ Ø¹Ù‚Ø¯">ğŸ“„ ØªØ¬Ø¯ÙŠØ¯ Ø¹Ù‚Ø¯</option> </optgroup> <optgroup label="ğŸ”„ Ø£Ø®Ø±Ù‰"> <option value="Ù…ØµØ§Ø±ÙŠÙ Ù…ØªÙ†ÙˆØ¹Ø©">ğŸ“Š Ù…ØµØ§Ø±ÙŠÙ Ù…ØªÙ†ÙˆØ¹Ø©</option> <option value="ØªØ¹ÙˆÙŠØ¶Ø§Øª">ğŸ’° ØªØ¹ÙˆÙŠØ¶Ø§Øª</option> <option value="Ø£Ø®Ø±Ù‰">â“ Ø£Ø®Ø±Ù‰</option> </optgroup> </select>
     </div>
     <div class="form-group"><label>ÙˆØµÙ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</label> <input type="text" id="debt-description-input" placeholder="Ù…Ø«Ø§Ù„: Ø¥ÙŠØ¬Ø§Ø± Ø´Ù‡Ø± ÙŠÙ†Ø§ÙŠØ± 2025" required>
     </div>
     <div class="form-group"><label>Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</label> <input type="number" id="debt-amount-input" min="0" step="0.01" placeholder="0.00" required>
     </div>
     <div class="form-group"><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</label> <input type="date" id="debt-due-date-input" required>
     </div>
     <div class="form-group"><label>Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø³ØªØ­Ù‚</label> <select id="debt-month-input" required> <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</option> <option value="ÙŠÙ†Ø§ÙŠØ±">ÙŠÙ†Ø§ÙŠØ±</option> <option value="ÙØ¨Ø±Ø§ÙŠØ±">ÙØ¨Ø±Ø§ÙŠØ±</option> <option value="Ù…Ø§Ø±Ø³">Ù…Ø§Ø±Ø³</option> <option value="Ø£Ø¨Ø±ÙŠÙ„">Ø£Ø¨Ø±ÙŠÙ„</option> <option value="Ù…Ø§ÙŠÙˆ">Ù…Ø§ÙŠÙˆ</option> <option value="ÙŠÙˆÙ†ÙŠÙˆ">ÙŠÙˆÙ†ÙŠÙˆ</option> <option value="ÙŠÙˆÙ„ÙŠÙˆ">ÙŠÙˆÙ„ÙŠÙˆ</option> <option value="Ø£ØºØ³Ø·Ø³">Ø£ØºØ³Ø·Ø³</option> <option value="Ø³Ø¨ØªÙ…Ø¨Ø±">Ø³Ø¨ØªÙ…Ø¨Ø±</option> <option value="Ø£ÙƒØªÙˆØ¨Ø±">Ø£ÙƒØªÙˆØ¨Ø±</option> <option value="Ù†ÙˆÙÙ…Ø¨Ø±">Ù†ÙˆÙÙ…Ø¨Ø±</option> <option value="Ø¯ÙŠØ³Ù…Ø¨Ø±">Ø¯ÙŠØ³Ù…Ø¨Ø±</option> </select>
     </div>
     <div class="form-group"><label>Ø§Ù„Ø³Ù†Ø©</label> <input type="number" id="debt-year-input" value="2025" required>
     </div>
     <div class="form-group"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label> <textarea id="debt-notes-input" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
     </div>
     <div class="flex gap-3 mt-6"><button type="submit" id="debt-submit-btn" class="flex-1 bg-gradient-to-r from-red-600 to-pink-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-red-700 hover:to-pink-700 transition-all"> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© </button> <button type="button" id="debt-cancel-btn" class="flex-1 bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition-all"> Ø¥Ù„ØºØ§Ø¡ </button>
     </div>
    </form>
   </div>
  </div><!-- Backup Modal -->
  <div id="backup-modal" class="modal">
   <div class="modal-content">
    <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ’¾ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
    <div class="backup-section">
     <h4 class="text-lg font-semibold mb-3">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
     <p class="text-gray-600 mb-3">Ø§Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±</p><button id="download-backup" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"> ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© </button>
    </div>
    <div class="backup-section">
     <h4 class="text-lg font-semibold mb-3">Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
     <p class="text-gray-600 mb-3">Ø§Ø³ØªØ¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</p><input type="file" id="restore-file" accept=".json"> <label for="restore-file" class="bg-blue-600 hover:bg-blue-700"> ğŸ“¤ Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© </label> <button id="restore-backup" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700" style="display:none;"> ğŸ”„ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª </button>
    </div>
    <div class="flex gap-3 mt-6"><button id="close-backup-modal" class="flex-1 bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition-all"> Ø¥ØºÙ„Ø§Ù‚ </button>
    </div>
   </div>
  </div>
  <script>
    let referenceApartments = [
      { id: "2", floor: "Ø§Ù„Ø£ÙˆÙ„", number: "101", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ¯ Ø³Ù„Ø·Ø§Ù†", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "3", floor: "Ø§Ù„Ø£ÙˆÙ„", number: "102", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ø±Ø¶Ø§ ÙˆÙ‡ÙŠØ¨", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "4", floor: "Ø§Ù„Ø«Ø§Ù†Ù‰", number: "201", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø§Ø¬Ø¯ Ù…Ø­Ù…Ø¯ Ø³Ø§Ù…ÙŠ", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "5", floor: "Ø§Ù„Ø«Ø§Ù†Ù‰", number: "202", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£- Ù…Ø­Ù…Ø¯", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "6", floor: "Ø§Ù„Ø«Ø§Ù„Ø«", number: "301", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£- Ø³ÙŠØ¯Ø© Ø¹Ù„ÙŠ", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "7", floor: "Ø§Ù„Ø«Ø§Ù„Ø«", number: "302", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø±ØªØ¶ÙŠ", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "8", floor: "Ø§Ù„Ø±Ø§Ø¨Ø¹", number: "401", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - ÙØ§Ø¯ÙŠ Ø³Ù…ÙŠØ±", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "9", floor: "Ø§Ù„Ø±Ø§Ø¨Ø¹", number: "402", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ù†ØªØµØ± Ø§Ø­Ù…Ø¯ Ø¹Ù„ÙŠ", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "11", floor: "Ø§Ù„Ø®Ø§Ù…Ø³", number: "502", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø§Ù„Ø­Ø§Ø¬ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ù†Ø¹Ù…", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "12", floor: "Ø§Ù„Ø³Ø§Ø¯Ø³", number: "601", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - ÙØ§Ø¯ÙŠ Ø±Ø§Ø´Ø¯", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "13", floor: "Ø§Ù„Ø³Ø§Ø¯Ø³", number: "602", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø­Ù…Ø¯ ÙŠÙˆØ³Ù", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "14", floor: "Ø§Ù„Ø³Ø§Ø¨Ø¹", number: "701", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø­Ù…Ø¯ Ù…Ø­Ø³Ù†", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "16", floor: "Ø§Ù„Ø«Ø§Ù…Ù†", number: "801", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³ÙŠØ¯", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "19", floor: "Ø§Ù„ØªØ§Ø³Ø¹", number: "902", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ø³Ù„Ø§Ù…Ø© Ù…Ø§Ø¶ÙŠ", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "20", floor: "Ø§Ù„Ø¹Ø§Ø´Ø±", number: "1001", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ø§Ø­Ù…Ø¯ Ø³Ø¹ÙŠØ¯", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "21", floor: "Ø§Ù„Ø¹Ø§Ø´Ø±", number: "1002", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ø¹Ø§Ø·Ù Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø²ÙŠØ²", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "23", floor: "Ø§Ù„Ø­Ø§Ø¯Ù‰ Ø¹Ø´Ø±", number: "1102", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ù… . Ø±Ø§Ù†ÙŠØ§ Ø±Ù…Ø²ÙŠ", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø³ØªØ£Ø¬Ø±" },
      { id: "24", floor: "Ø§Ù„Ø«Ø§Ù†Ù‰ Ø¹Ø´Ø±", number: "1201", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø´ÙŠÙ„ Ø§Ù†Ø·ÙˆÙ†ÙŠÙˆØ³", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "25", floor: "Ø§Ù„Ø«Ø§Ù†Ù‰ Ø¹Ø´Ø±", number: "1202", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø£ - Ù…Ø­Ù…Ø¯ Ø¬Ù…Ø§Ù„ Ø§Ø­Ù…Ø¯", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "26", floor: "Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±", number: "1301", location: "ÙŠÙ…ÙŠÙ† Ø§Ù„Ø³Ù„Ù…", resident: "Ù… . Ø¬ÙˆØ±Ø¬ÙŠØª Ø­Ø¨ÙŠØ¨", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" },
      { id: "27", floor: "Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±", number: "1302", location: "ÙŠØ³Ø§Ø± Ø§Ù„Ø³Ù„Ù…", resident: "Ø¯. Ø³Ø§Ù…ÙŠ Ø¹Ø§Ø¯Ù„", status: "Ø³Ø§ÙƒÙ†Ø©", type: "Ù…Ø§Ù„Ùƒ" }
    ];

    let allPayments = [];
    let allDebts = [];
    let currentEditingPayment = null;
    let currentEditingApartment = null;
    let filteredApartments = [...referenceApartments];

    // Local Storage Functions
    function saveToLocalStorage() {
      localStorage.setItem('propertyManagementData', JSON.stringify(allPayments));
      localStorage.setItem('propertyDebtsData', JSON.stringify(allDebts));
      localStorage.setItem('propertyApartmentsData', JSON.stringify(referenceApartments));
    }

    function loadFromLocalStorage() {
      const paymentsData = localStorage.getItem('propertyManagementData');
      if (paymentsData) {
        allPayments = JSON.parse(paymentsData);
      }
      
      const debtsData = localStorage.getItem('propertyDebtsData');
      if (debtsData) {
        allDebts = JSON.parse(debtsData);
      }
      
      const apartmentsData = localStorage.getItem('propertyApartmentsData');
      if (apartmentsData) {
        referenceApartments = JSON.parse(apartmentsData);
        filteredApartments = [...referenceApartments];
      }
    }

    function initializeApp() {
      loadFromLocalStorage();
      populateApartmentSelect();
      populateFloorFilter();
      setupEventListeners();
      applyFilters();
      updateStatistics();
    }

    function populateFloorFilter() {
      const floorSelect = document.getElementById('filter-floor');
      floorSelect.innerHTML = '<option value="">Ø§Ù„ÙƒÙ„</option>';
      const floors = [...new Set(referenceApartments.map(apt => apt.floor))];
      
      floors.forEach(floor => {
        const option = document.createElement('option');
        option.value = floor;
        option.textContent = floor;
        floorSelect.appendChild(option);
      });
    }

    function populateApartmentSelect() {
      const select = document.getElementById('apartment-select');
      const debtSelect = document.getElementById('debt-apartment-select');
      
      select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‚Ø©</option>';
      debtSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‚Ø©</option>';
      
      referenceApartments.forEach(apt => {
        const option = document.createElement('option');
        option.value = apt.id;
        option.textContent = `${apt.number} - ${apt.resident} (${apt.floor})`;
        select.appendChild(option);
        
        const debtOption = document.createElement('option');
        debtOption.value = apt.id;
        debtOption.textContent = `${apt.number} - ${apt.resident} (${apt.floor})`;
        debtSelect.appendChild(debtOption);
      });
    }

    function applyFilters() {
      const searchName = document.getElementById('search-name')?.value.toLowerCase() || '';
      const filterType = document.getElementById('filter-type')?.value || '';
      const filterPayment = document.getElementById('filter-payment')?.value || '';
      const filterFloor = document.getElementById('filter-floor')?.value || '';

      filteredApartments = referenceApartments.filter(apt => {
        const payment = allPayments.find(p => p.apartment_id === apt.id);
        
        const matchesName = apt.resident.toLowerCase().includes(searchName);
        const matchesType = !filterType || apt.type === filterType;
        const matchesPayment = !filterPayment || (payment && payment.payment_status === filterPayment);
        const matchesFloor = !filterFloor || apt.floor === filterFloor;
        
        return matchesName && matchesType && matchesPayment && matchesFloor;
      });
      
      renderTable();
    }

    function renderTable() {
      const tbody = document.getElementById('table-body');
      tbody.innerHTML = '';
      
      filteredApartments.forEach(apt => {
        const payment = allPayments.find(p => p.apartment_id === apt.id);
        const row = document.createElement('tr');
        
        const amount = payment?.amount || 0;
        const paid = payment?.paid || 0;
        const paymentDebt = amount - paid;
        const registeredDebt = allDebts.filter(d => d.apartment_id === apt.id).reduce((sum, d) => sum + d.amount, 0);
        const debt = paymentDebt + registeredDebt;
        
        let paymentStatusBadge = '-';
        if (payment) {
          const badgeClass = payment.payment_status === 'Ù…Ø¯ÙÙˆØ¹' ? 'paid-badge' : 
                           payment.payment_status === 'Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ' ? 'partial-badge' : 'unpaid-badge';
          paymentStatusBadge = `<span class="${badgeClass}">${payment.payment_status}</span>`;
        }
        
        row.innerHTML = `
          <td>${apt.id}</td>
          <td>${apt.floor}</td>
          <td>${apt.number}</td>
          <td>${apt.location}</td>
          <td>${apt.resident}</td>
          <td>${apt.status}</td>
          <td><span class="${apt.type === 'Ù…Ø§Ù„Ùƒ' ? 'owner-badge' : 'tenant-badge'}">${apt.type}</span></td>
          <td>${amount.toFixed(2)}</td>
          <td>${paid.toFixed(2)}</td>
          <td>${paymentStatusBadge}</td>
          <td>${debt.toFixed(2)}</td>
          <td>${payment?.payment_type || '-'}</td>
          <td>${payment?.notes || '-'}</td>
          <td>${payment?.payment_method || '-'}</td>
          <td>
            <div class="action-buttons">
              <button onclick="editApartment('${apt.id}')" class="bg-green-500 text-white rounded hover:bg-green-600">
                ğŸ  ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø´Ù‚Ø©
              </button>
              <button onclick="editPayment('${apt.id}')" class="bg-blue-500 text-white rounded hover:bg-blue-600">
                ${payment ? 'ğŸ’° ØªØ¹Ø¯ÙŠÙ„ Ø¯ÙØ¹Ø©' : 'â• Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø©'}
              </button>
              <button onclick="viewDebts('${apt.id}')" class="bg-orange-500 text-white rounded hover:bg-orange-600">
                ğŸ“‹ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©
              </button>
              ${payment ? `<button onclick="deletePayment('${apt.id}')" class="bg-red-500 text-white rounded hover:bg-red-600">ğŸ—‘ï¸ Ø­Ø°Ù Ø¯ÙØ¹Ø©</button>` : ''}
            </div>
          </td>
        `;
        
        tbody.appendChild(row);
      });
    }

    function updateStatistics() {
      const totalApartments = referenceApartments.length;
      const totalPaid = allPayments.reduce((sum, p) => sum + (p.paid || 0), 0);
      const totalAmount = allPayments.reduce((sum, p) => sum + (p.amount || 0), 0);
      const paymentDebt = totalAmount - totalPaid;
      const registeredDebt = allDebts.reduce((sum, d) => sum + (d.amount || 0), 0);
      const totalDebt = paymentDebt + registeredDebt;
      const totalTenants = referenceApartments.filter(a => a.type === 'Ù…Ø³ØªØ£Ø¬Ø±').length;
      const collectionRate = totalAmount > 0 ? ((totalPaid / totalAmount) * 100).toFixed(1) : 0;
      
      document.getElementById('total-apartments').textContent = totalApartments;
      document.getElementById('total-paid').textContent = totalPaid.toFixed(2) + ' Ø¬Ù†ÙŠÙ‡';
      document.getElementById('total-debt').textContent = totalDebt.toFixed(2) + ' Ø¬Ù†ÙŠÙ‡';
      document.getElementById('total-tenants').textContent = totalTenants;
      document.getElementById('collection-rate').textContent = collectionRate + '%';
    }

    function setupEventListeners() {
      document.getElementById('add-debt-btn').addEventListener('click', () => {
        document.getElementById('debt-form').reset();
        document.getElementById('debt-year-input').value = '2025';
        const today = new Date();
        document.getElementById('debt-due-date-input').value = today.toISOString().split('T')[0];
        document.getElementById('debt-modal').classList.add('active');
      });
      
      document.getElementById('add-payment-btn').addEventListener('click', () => {
        currentEditingPayment = null;
        document.getElementById('modal-title').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©';
        document.getElementById('payment-form').reset();
        document.getElementById('year-input').value = '2025';
        document.getElementById('payment-modal').classList.add('active');
      });
      
      document.getElementById('cancel-btn').addEventListener('click', () => {
        document.getElementById('payment-modal').classList.remove('active');
      });
      
      document.getElementById('debt-cancel-btn').addEventListener('click', () => {
        document.getElementById('debt-modal').classList.remove('active');
      });
      
      document.getElementById('apt-cancel-btn').addEventListener('click', () => {
        document.getElementById('apartment-modal').classList.remove('active');
      });
      
      document.getElementById('payment-form').addEventListener('submit', handleFormSubmit);
      document.getElementById('debt-form').addEventListener('submit', handleDebtFormSubmit);
      document.getElementById('apartment-form').addEventListener('submit', handleApartmentFormSubmit);
      
      // Filter event listeners
      document.getElementById('search-name').addEventListener('input', applyFilters);
      document.getElementById('filter-type').addEventListener('change', applyFilters);
      document.getElementById('filter-payment').addEventListener('change', applyFilters);
      document.getElementById('filter-floor').addEventListener('change', applyFilters);
      document.getElementById('clear-filters').addEventListener('click', clearFilters);
      
      // Export and print listeners
      document.getElementById('export-btn').addEventListener('click', exportToExcel);
      document.getElementById('print-btn').addEventListener('click', printReport);
      document.getElementById('backup-btn').addEventListener('click', () => {
        document.getElementById('backup-modal').classList.add('active');
      });
      document.getElementById('close-backup-modal').addEventListener('click', () => {
        document.getElementById('backup-modal').classList.remove('active');
      });
      
      // Backup listeners
      document.getElementById('download-backup').addEventListener('click', downloadBackup);
      document.getElementById('restore-file').addEventListener('change', handleFileSelect);
      document.getElementById('restore-backup').addEventListener('click', restoreBackup);
    }

    function clearFilters() {
      document.getElementById('search-name').value = '';
      document.getElementById('filter-type').value = '';
      document.getElementById('filter-payment').value = '';
      document.getElementById('filter-floor').value = '';
      applyFilters();
    }

    function exportToExcel() {
      let csvContent = "Ù…,Ø§Ù„Ø¯ÙˆØ±,Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©,Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ù‚Ø©,Ø§Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ†,Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ù‚Ø©,Ù†ÙˆØ¹ Ø§Ù„Ø³Ø§ÙƒÙ†,Ø§Ù„Ù…Ø¨Ù„Øº,Ø¯ÙØ¹,Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯,Ø¯ÙŠÙˆÙ†,Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø©,Ù…Ù„Ø§Ø­Ø¸Ø§Øª,Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹\n";
      
      filteredApartments.forEach(apt => {
        const payment = allPayments.find(p => p.apartment_id === apt.id);
        const amount = payment?.amount || 0;
        const paid = payment?.paid || 0;
        const paymentDebt = amount - paid;
        const registeredDebt = allDebts.filter(d => d.apartment_id === apt.id).reduce((sum, d) => sum + d.amount, 0);
        const debt = paymentDebt + registeredDebt;
        
        const row = [
          apt.id,
          apt.floor,
          apt.number,
          apt.location,
          apt.resident,
          apt.status,
          apt.type,
          amount.toFixed(2),
          paid.toFixed(2),
          payment?.payment_status || '-',
          debt.toFixed(2),
          payment?.payment_type || '-',
          payment?.notes || '-',
          payment?.payment_method || '-'
        ].map(field => `"${field}"`).join(',');
        
        csvContent += row + "\n";
      });
      
      const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø¹Ù‚Ø§Ø±_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showMessage('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }

    function printReport() {
      const printWindow = window.open('', '_blank');
      const printContent = `
        <!DOCTYPE html>
        <html dir="rtl">
        <head>
          <meta charset="UTF-8">
          <title>ØªÙ‚Ø±ÙŠØ± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: center; font-size: 12px; }
            th { background-color: #f2f2f2; font-weight: bold; }
            .stats { display: flex; justify-content: space-around; margin: 20px 0; }
            .stat-box { text-align: center; padding: 10px; border: 1px solid #ddd; }
            @media print { body { margin: 0; } }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ğŸ¢ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±</h1>
            <h2>ØªØ¬Ù…ÙŠØ¹ Ø§ÙŠØµØ§Ù„ Ø´Ù‡Ø± - Ø¹Ø§Ù… 2025 Ù…</h2>
            <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${new Date().toLocaleDateString('ar-EG')}</p>
          </div>
          
          <div class="stats">
            <div class="stat-box">
              <strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ù‚Ù‚</strong><br>
              ${filteredApartments.length}
            </div>
            <div class="stat-box">
              <strong>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ØµÙ„</strong><br>
              ${allPayments.reduce((sum, p) => sum + (p.paid || 0), 0).toFixed(2)} Ø¬Ù†ÙŠÙ‡
            </div>
            <div class="stat-box">
              <strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†</strong><br>
              ${allPayments.reduce((sum, p) => sum + ((p.amount || 0) - (p.paid || 0)), 0).toFixed(2)} Ø¬Ù†ÙŠÙ‡
            </div>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>Ù…</th><th>Ø§Ù„Ø¯ÙˆØ±</th><th>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©</th><th>Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ù‚Ø©</th>
                <th>Ø§Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ†</th><th>Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ù‚Ø©</th><th>Ù†ÙˆØ¹ Ø§Ù„Ø³Ø§ÙƒÙ†</th>
                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø¯ÙØ¹</th><th>Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯</th><th>Ø¯ÙŠÙˆÙ†</th>
                <th>Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø©</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th><th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</th>
              </tr>
            </thead>
            <tbody>
              ${filteredApartments.map(apt => {
                const payment = allPayments.find(p => p.apartment_id === apt.id);
                const amount = payment?.amount || 0;
                const paid = payment?.paid || 0;
                const debt = amount - paid;
                
                return `
                  <tr>
                    <td>${apt.id}</td>
                    <td>${apt.floor}</td>
                    <td>${apt.number}</td>
                    <td>${apt.location}</td>
                    <td>${apt.resident}</td>
                    <td>${apt.status}</td>
                    <td>${apt.type}</td>
                    <td>${amount.toFixed(2)}</td>
                    <td>${paid.toFixed(2)}</td>
                    <td>${payment?.payment_status || '-'}</td>
                    <td>${debt.toFixed(2)}</td>
                    <td>${payment?.payment_type || '-'}</td>
                    <td>${payment?.notes || '-'}</td>
                    <td>${payment?.payment_method || '-'}</td>
                  </tr>
                `;
              }).join('')}
            </tbody>
          </table>
        </body>
        </html>
      `;
      
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.focus();
      setTimeout(() => {
        printWindow.print();
        printWindow.close();
      }, 250);
      
      showMessage('ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©', 'success');
    }

    // Backup Functions
    function downloadBackup() {
      const backupData = {
        version: "1.2",
        timestamp: new Date().toISOString(),
        payments: allPayments,
        debts: allDebts,
        apartments: referenceApartments
      };
      
      const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `Ù†Ø³Ø®Ø©_Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©_Ø§Ù„Ø¹Ù‚Ø§Ø±_${new Date().toISOString().split('T')[0]}.json`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showMessage('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }

    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) {
        document.getElementById('restore-backup').style.display = 'inline-block';
      }
    }

    function restoreBackup() {
      const fileInput = document.getElementById('restore-file');
      const file = fileInput.files[0];
      
      if (!file) {
        showMessage('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ù„Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©', 'error');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const backupData = JSON.parse(e.target.result);
          
          if (backupData.payments) {
            allPayments = backupData.payments;
          }
          if (backupData.debts) {
            allDebts = backupData.debts;
          }
          if (backupData.apartments) {
            referenceApartments = backupData.apartments;
            filteredApartments = [...referenceApartments];
          }
          
          saveToLocalStorage();
          populateApartmentSelect();
          populateFloorFilter();
          applyFilters();
          updateStatistics();
          showMessage('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
          document.getElementById('backup-modal').classList.remove('active');
        } catch (error) {
          showMessage('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'error');
        }
      };
      
      reader.readAsText(file);
    }

    function handleDebtFormSubmit(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('debt-submit-btn');
      submitBtn.classList.add('loading');
      submitBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...';
      
      const apartmentId = document.getElementById('debt-apartment-select').value;
      const debtType = document.getElementById('debt-type-input').value;
      const description = document.getElementById('debt-description-input').value;
      const amount = parseFloat(document.getElementById('debt-amount-input').value);
      const dueDate = document.getElementById('debt-due-date-input').value;
      const month = document.getElementById('debt-month-input').value;
      const year = parseInt(document.getElementById('debt-year-input').value);
      const notes = document.getElementById('debt-notes-input').value;
      
      const apartment = referenceApartments.find(a => a.id === apartmentId);
      
      const debtData = {
        id: Date.now().toString(),
        apartment_id: apartmentId,
        floor: apartment.floor,
        apartment_number: apartment.number,
        location: apartment.location,
        resident_name: apartment.resident,
        resident_type: apartment.type,
        debt_type: debtType,
        description: description,
        amount: amount,
        due_date: dueDate,
        month: month,
        year: year,
        notes: notes,
        status: 'Ù…Ø³ØªØ­Ù‚Ø©',
        created_at: new Date().toISOString()
      };
      
      allDebts.push(debtData);
      
      saveToLocalStorage();
      applyFilters();
      updateStatistics();
      
      submitBtn.classList.remove('loading');
      submitBtn.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©';
      
      document.getElementById('debt-modal').classList.remove('active');
      showMessage('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }

    function handleFormSubmit(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submit-btn');
      submitBtn.classList.add('loading');
      submitBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
      
      const apartmentId = document.getElementById('apartment-select').value;
      const paymentType = document.getElementById('payment-type-input').value;
      const amount = parseFloat(document.getElementById('amount-input').value);
      const paid = parseFloat(document.getElementById('paid-input').value);
      const paymentStatus = document.getElementById('payment-status-input').value;
      const paymentMethod = document.getElementById('payment-method-input').value;
      const month = document.getElementById('month-input').value;
      const year = parseInt(document.getElementById('year-input').value);
      const notes = document.getElementById('notes-input').value;
      
      const apartment = referenceApartments.find(a => a.id === apartmentId);
      const debt = amount - paid;
      
      const paymentData = {
        id: currentEditingPayment ? currentEditingPayment.id : Date.now().toString(),
        apartment_id: apartmentId,
        floor: apartment.floor,
        apartment_number: apartment.number,
        location: apartment.location,
        resident_name: apartment.resident,
        status: apartment.status,
        resident_type: apartment.type,
        payment_type: paymentType,
        amount: amount,
        paid: paid,
        payment_status: paymentStatus,
        debt: debt,
        notes: notes,
        payment_method: paymentMethod,
        month: month,
        year: year,
        created_at: currentEditingPayment ? currentEditingPayment.created_at : new Date().toISOString(),
        updated_at: new Date().toISOString()
      };
      
      if (currentEditingPayment) {
        const index = allPayments.findIndex(p => p.id === currentEditingPayment.id);
        allPayments[index] = paymentData;
      } else {
        const existingIndex = allPayments.findIndex(p => p.apartment_id === apartmentId);
        if (existingIndex >= 0) {
          paymentData.id = allPayments[existingIndex].id;
          paymentData.created_at = allPayments[existingIndex].created_at;
          allPayments[existingIndex] = paymentData;
        } else {
          allPayments.push(paymentData);
        }
      }
      
      saveToLocalStorage();
      applyFilters();
      updateStatistics();
      
      submitBtn.classList.remove('loading');
      submitBtn.textContent = 'Ø­ÙØ¸';
      
      document.getElementById('payment-modal').classList.remove('active');
      showMessage('ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }

    function handleApartmentFormSubmit(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('apt-submit-btn');
      submitBtn.classList.add('loading');
      submitBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
      
      const floor = document.getElementById('apt-floor-input').value;
      const number = document.getElementById('apt-number-input').value;
      const location = document.getElementById('apt-location-input').value;
      const resident = document.getElementById('apt-resident-input').value;
      const status = document.getElementById('apt-status-input').value;
      const type = document.getElementById('apt-type-input').value;
      
      if (currentEditingApartment) {
        const index = referenceApartments.findIndex(a => a.id === currentEditingApartment.id);
        if (index >= 0) {
          referenceApartments[index] = {
            ...referenceApartments[index],
            floor: floor,
            number: number,
            location: location,
            resident: resident,
            status: status,
            type: type
          };
          
          // Update any existing payments with new apartment data
          const paymentIndex = allPayments.findIndex(p => p.apartment_id === currentEditingApartment.id);
          if (paymentIndex >= 0) {
            allPayments[paymentIndex] = {
              ...allPayments[paymentIndex],
              floor: floor,
              apartment_number: number,
              location: location,
              resident_name: resident,
              status: status,
              resident_type: type,
              updated_at: new Date().toISOString()
            };
          }
        }
      }
      
      saveToLocalStorage();
      populateApartmentSelect();
      populateFloorFilter();
      applyFilters();
      updateStatistics();
      
      submitBtn.classList.remove('loading');
      submitBtn.textContent = 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
      
      document.getElementById('apartment-modal').classList.remove('active');
      showMessage('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }

    window.editApartment = function(apartmentId) {
      const apartment = referenceApartments.find(a => a.id === apartmentId);
      if (!apartment) return;
      
      currentEditingApartment = apartment;
      
      document.getElementById('apt-floor-input').value = apartment.floor;
      document.getElementById('apt-number-input').value = apartment.number;
      document.getElementById('apt-location-input').value = apartment.location;
      document.getElementById('apt-resident-input').value = apartment.resident;
      document.getElementById('apt-status-input').value = apartment.status;
      document.getElementById('apt-type-input').value = apartment.type;
      
      document.getElementById('apartment-modal').classList.add('active');
    };

    window.editPayment = function(apartmentId) {
      const payment = allPayments.find(p => p.apartment_id === apartmentId);
      const apartment = referenceApartments.find(a => a.id === apartmentId);
      
      currentEditingPayment = payment;
      document.getElementById('modal-title').textContent = payment ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹Ø©' : 'Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©';
      
      document.getElementById('apartment-select').value = apartmentId;
      document.getElementById('payment-type-input').value = payment?.payment_type || '';
      document.getElementById('amount-input').value = payment?.amount || '';
      document.getElementById('paid-input').value = payment?.paid || '';
      document.getElementById('payment-status-input').value = payment?.payment_status || '';
      document.getElementById('payment-method-input').value = payment?.payment_method || '';
      document.getElementById('month-input').value = payment?.month || '';
      document.getElementById('year-input').value = payment?.year || 2025;
      document.getElementById('notes-input').value = payment?.notes || '';
      
      document.getElementById('payment-modal').classList.add('active');
    };

    window.viewDebts = function(apartmentId) {
      const apartment = referenceApartments.find(a => a.id === apartmentId);
      const apartmentDebts = allDebts.filter(d => d.apartment_id === apartmentId);
      
      if (!apartment) return;
      
      let debtsHtml = '';
      if (apartmentDebts.length === 0) {
        debtsHtml = '<p class="text-gray-500 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ§Øª Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø´Ù‚Ø©</p>';
      } else {
        debtsHtml = `
          <div class="space-y-3">
            ${apartmentDebts.map(debt => `
              <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
                <div class="flex justify-between items-start mb-2">
                  <h4 class="font-semibold text-gray-800">${debt.debt_type}</h4>
                  <span class="text-red-600 font-bold">${debt.amount.toFixed(2)} Ø¬Ù†ÙŠÙ‡</span>
                </div>
                <p class="text-gray-600 mb-2">${debt.description}</p>
                <div class="grid grid-cols-2 gap-2 text-sm text-gray-500">
                  <div>ğŸ“… Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: ${new Date(debt.due_date).toLocaleDateString('ar-EG')}</div>
                  <div>ğŸ“† Ø§Ù„Ø´Ù‡Ø±: ${debt.month} ${debt.year}</div>
                </div>
                ${debt.notes ? `<p class="text-sm text-gray-500 mt-2">ğŸ’¬ ${debt.notes}</p>` : ''}
                <div class="mt-3 flex gap-2">
                  <button onclick="deleteDebt('${debt.id}')" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">
                    ğŸ—‘ï¸ Ø­Ø°Ù
                  </button>
                </div>
              </div>
            `).join('')}
          </div>
        `;
      }
      
      const modal = document.createElement('div');
      modal.className = 'modal active';
      modal.innerHTML = `
        <div class="modal-content">
          <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“‹ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ§Øª Ø§Ù„Ø´Ù‚Ø© ${apartment.number}</h3>
          <div class="mb-4 p-3 bg-blue-50 rounded-lg">
            <p><strong>Ø§Ù„Ø³Ø§ÙƒÙ†:</strong> ${apartment.resident}</p>
            <p><strong>Ø§Ù„Ø¯ÙˆØ±:</strong> ${apartment.floor}</p>
            <p><strong>Ø§Ù„Ù…ÙƒØ§Ù†:</strong> ${apartment.location}</p>
          </div>
          ${debtsHtml}
          <div class="flex gap-3 mt-6">
            <button id="close-debts-modal" class="flex-1 bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition-all">
              Ø¥ØºÙ„Ø§Ù‚
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      document.getElementById('close-debts-modal').addEventListener('click', () => {
        document.body.removeChild(modal);
      });
    };

    window.deleteDebt = function(debtId) {
      const confirmDiv = document.createElement('div');
      confirmDiv.className = 'modal active';
      confirmDiv.innerHTML = `
        <div class="modal-content text-center">
          <h3 class="text-xl font-bold text-gray-800 mb-4">ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</h3>
          <p class="text-gray-600 mb-6">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©ØŸ</p>
          <div class="flex gap-3 justify-center">
            <button id="confirm-delete-debt" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Ø­Ø°Ù</button>
            <button id="cancel-delete-debt" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400">Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(confirmDiv);
      
      document.getElementById('confirm-delete-debt').addEventListener('click', () => {
        const index = allDebts.findIndex(d => d.id === debtId);
        if (index >= 0) {
          allDebts.splice(index, 1);
          saveToLocalStorage();
          applyFilters();
          updateStatistics();
          showMessage('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
          
          // Close both modals
          document.body.removeChild(confirmDiv);
          const debtsModal = document.querySelector('.modal.active');
          if (debtsModal) {
            document.body.removeChild(debtsModal);
          }
        }
      });
      
      document.getElementById('cancel-delete-debt').addEventListener('click', () => {
        document.body.removeChild(confirmDiv);
      });
    };

    window.deletePayment = function(apartmentId) {
      const payment = allPayments.find(p => p.apartment_id === apartmentId);
      if (!payment) return;
      
      const confirmDiv = document.createElement('div');
      confirmDiv.className = 'modal active';
      confirmDiv.innerHTML = `
        <div class="modal-content text-center">
          <h3 class="text-xl font-bold text-gray-800 mb-4">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h3>
          <p class="text-gray-600 mb-6">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙØ¹Ø©ØŸ</p>
          <div class="flex gap-3 justify-center">
            <button id="confirm-delete" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Ø­Ø°Ù</button>
            <button id="cancel-delete" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400">Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(confirmDiv);
      
      document.getElementById('confirm-delete').addEventListener('click', () => {
        const index = allPayments.findIndex(p => p.apartment_id === apartmentId);
        if (index >= 0) {
          allPayments.splice(index, 1);
          saveToLocalStorage();
          applyFilters();
          updateStatistics();
          showMessage('ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        document.body.removeChild(confirmDiv);
      });
      
      document.getElementById('cancel-delete').addEventListener('click', () => {
        document.body.removeChild(confirmDiv);
      });
    };

    function showMessage(message, type) {
      const toast = document.createElement('div');
      toast.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg text-white font-semibold shadow-lg z-50 ${type === 'success' ? 'bg-green-600' : 'bg-red-600'}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        if (document.body.contains(toast)) {
          document.body.removeChild(toast);
        }
      }, 3000);
    }

    // Initialize the app when page loads
    document.addEventListener('DOMContentLoaded', initializeApp);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99be6d51264ce221',t:'MTc2MjcwMzAxOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
